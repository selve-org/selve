generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                  String       @id @default(cuid())
  email               String       @unique
  name                String?
  createdAt           DateTime     @default(now())
  updatedAt           DateTime     @updatedAt
  clerkId             String       @unique
  inviteLinksSent     InviteLink[] @relation("InviterRelation")
  inviteLinksReceived InviteLink[] @relation("TargetRelation")
  profile             Profile?
  responsesAbout      Response[]   @relation("ResponsesAbout")
  responsesGiven      Response[]   @relation("ResponsesGiven")
}

model Profile {
  id          String   @id @default(uuid())
  userId      String   @unique
  bio         String?
  avatarUrl   String?
  personality Json?
  createdAt   DateTime @default(now())
  user        User     @relation(fields: [userId], references: [id])
}

model Question {
  id           String     @id @default(uuid())
  text         String
  category     String?
  isThirdParty Boolean    @default(false)
  createdAt    DateTime   @default(now())
  responses    Response[]
}

model Response {
  id             String   @id @default(uuid())
  questionId     String
  answeredById   String
  aboutUserId    String
  answer         String
  createdAt      DateTime @default(now())
  aboutUser      User     @relation("ResponsesAbout", fields: [aboutUserId], references: [id])
  answeredByUser User     @relation("ResponsesGiven", fields: [answeredById], references: [id])
  question       Question @relation(fields: [questionId], references: [id])
}

model InviteLink {
  id        String    @id @default(uuid())
  code      String    @unique
  inviterId String
  targetId  String
  expiresAt DateTime?
  createdAt DateTime  @default(now())
  inviter   User      @relation("InviterRelation", fields: [inviterId], references: [id])
  target    User      @relation("TargetRelation", fields: [targetId], references: [id])
}
